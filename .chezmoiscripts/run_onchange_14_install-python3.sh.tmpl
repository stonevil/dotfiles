#!/usr/bin/env sh
# vim:ft=go

cd "$HOME" || exit 1

if command -v pip3 >/dev/null; then
echo "Install Python pip3 packges"
#Â pip3.packages hash: {{ include ".packagefiles/pip3.packages" | sha256sum }}
	if [[ -f {{ joinPath .chezmoi.sourceDir ".packagefiles/pip3.packages" | quote }} ]] && [[ -s {{ joinPath .chezmoi.sourceDir ".packagefiles/pip3.packages" | quote }} ]]; then
		export PYTHON_KEYRING_BACKEND="keyring.backends.null.Keyring"
{{ if and (eq .chezmoi.os "linux") (eq .chezmoi.osRelease.id "centos") }}
		pip3 install --disable-pip-version-check --no-cache-dir --upgrade --force-reinstall --install-option="--install-scripts=$HOME/.local/bin" --target "$HOME"/.local/python3 -r {{ joinPath .chezmoi.sourceDir ".packagefiles/pip3.packages" | quote }} || exit 1
{{ else }}
		pip3 install --no-warn-script-location --disable-pip-version-check --no-cache-dir --upgrade --use-pep517 --force-reinstall --install-option="--install-scripts=$HOME/.local/bin" --target "$HOME"/.local/python3 -r {{ joinPath .chezmoi.sourceDir ".packagefiles/pip3.packages" | quote }} || exit 1
{{ end }}
	fi
fi
