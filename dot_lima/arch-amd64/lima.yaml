vmType: "qemu"
arch: "x86_64"

cpus: 6

mounts:
- location: "~"
  writable: false

containerd:
  system: false
  user: false

images:
- location: "https://geo.mirror.pkgbuild.com/images/v20251201.460866/Arch-Linux-x86_64-cloudimg-20251201.460866.qcow2"
  arch: "x86_64"
  digest: "sha256:53deacc97a595e7438259b802f72a952e38a545385e2810233e58ab6281dd5f7"

provision:
- mode: system
  script: |
    #!/bin/bash
    set -eux -o pipefail
    sed -i '/^OPTIONS=(/s/debug/!debug/' /etc/makepkg.conf
    pacman --noconfirm --needed --sync --refresh --sysupgrade
    pacman --noconfirm --needed --sync glibc-locales bash less curl tar wget git base-devel go
- mode: user
  script: |
    #!/bin/bash
    set -eux -o pipefail
    git clone https://aur.archlinux.org/yay.git && cd yay && makepkg -sif --noconfirm && cd .. && rm -Rf yay

env:
  CODESPACES: true
